\doxysection{covariances.\+hpp}
\hypertarget{covariances_8hpp_source}{}\label{covariances_8hpp_source}\index{/home/baptisteh/Documents/code/robots/RGB\_SLAM/RGB-\/D-\/SLAM/src/utils/covariances.hpp@{/home/baptisteh/Documents/code/robots/RGB\_SLAM/RGB-\/D-\/SLAM/src/utils/covariances.hpp}}
\mbox{\hyperlink{covariances_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ RGBDSLAM\_UTILS\_COVARIANCES\_HPP}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ RGBDSLAM\_UTILS\_COVARIANCES\_HPP}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{plane__coordinates_8hpp}{coordinates/plane\_coordinates.hpp}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{point__coordinates_8hpp}{coordinates/point\_coordinates.hpp}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{logger_8hpp}{logger.hpp}}"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{types_8hpp}{types.hpp}}"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <Eigen/src/Core/Matrix.h>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <bits/ranges\_algo.h>}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacergbd__slam_1_1utils}{rgbd\_slam::utils}}\ \{}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ N>\ [[nodiscard]]\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacergbd__slam_1_1utils_a9cbda3c897f333211ee9d67b329dcec5}{is\_covariance\_valid}}(\textcolor{keyword}{const}\ Eigen::Matrix<double,\ N,\ N>\&\ covariance)\ \textcolor{keyword}{noexcept}}
\DoxyCodeLine{00014\ \{}
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{comment}{//\ no\ invalid\ values}}
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{keywordflow}{if}\ (covariance.hasNaN())}
\DoxyCodeLine{00017\ \ \ \ \ \{}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacergbd__slam_1_1outputs_ab717e4badd78d57b03feca68cd4265c0}{outputs::log\_warning}}(\textcolor{stringliteral}{"{}Covariance\ has\ invalid\ values"{}});}
\DoxyCodeLine{00019\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00020\ \ \ \ \ \}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{comment}{//\ special\ case:\ 1\ dimention\ covariance}}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{keywordflow}{if}\ (N\ ==\ 1)}
\DoxyCodeLine{00024\ \ \ \ \ \{}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ covariance(0,\ 0)\ >=\ 0;}
\DoxyCodeLine{00026\ \ \ \ \ \}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{comment}{//\ covariance\ should\ be\ symetrical}}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keywordflow}{if}\ (!covariance.isApprox(covariance.transpose()))}
\DoxyCodeLine{00030\ \ \ \ \ \{}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacergbd__slam_1_1outputs_ab717e4badd78d57b03feca68cd4265c0}{outputs::log\_warning}}(\textcolor{stringliteral}{"{}Covariance\ is\ not\ symetrical"{}});}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00033\ \ \ \ \ \}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{comment}{//\ check\ that\ this\ covariance\ is\ positive\ semi\ definite}}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ ldlt\ =\ covariance.template\ selfadjointView<Eigen::Upper>().ldlt();}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordflow}{if}\ (ldlt.info()\ ==\ Eigen::NumericalIssue\ ||\ !ldlt.isPositive())}
\DoxyCodeLine{00038\ \ \ \ \ \{}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacergbd__slam_1_1outputs_ab717e4badd78d57b03feca68cd4265c0}{outputs::log\_warning}}(\textcolor{stringliteral}{"{}Covariance\ is\ not\ positive\ semi\ definite"{}});}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00041\ \ \ \ \ \}}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00043\ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00050\ [[nodiscard]]\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacergbd__slam_1_1utils_a034845c6434a68e6e6002f4f6277ab2c}{get\_depth\_quantization}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ depht)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00058\ [[nodiscard]]\ \mbox{\hyperlink{structrgbd__slam_1_1_screen_coordinate_covariance}{ScreenCoordinateCovariance}}\ \mbox{\hyperlink{namespacergbd__slam_1_1utils_a1e7d30fceb1656c046225f4885da0a31}{get\_screen\_point\_covariance}}(}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ WorldCoordinate\&\ point,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structrgbd__slam_1_1_world_coordinate_covariance}{WorldCoordinateCovariance}}\&\ pointCovariance)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00067\ [[nodiscard]]\ \mbox{\hyperlink{structrgbd__slam_1_1_screen_coordinate_covariance}{ScreenCoordinateCovariance}}\ \mbox{\hyperlink{namespacergbd__slam_1_1utils_a1e7d30fceb1656c046225f4885da0a31}{get\_screen\_point\_covariance}}(}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ CameraCoordinate\&\ point,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structrgbd__slam_1_1_camera_coordinate_covariance}{CameraCoordinateCovariance}}\&\ pointCovariance)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00076\ \mbox{\hyperlink{structrgbd__slam_1_1_camera_coordinate_covariance}{CameraCoordinateCovariance}}\ \mbox{\hyperlink{namespacergbd__slam_1_1utils_a115c8ecf807d5970f1ad789bfedb04b4}{get\_camera\_point\_covariance}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structrgbd__slam_1_1_world_coordinate_covariance}{WorldCoordinateCovariance}}\&\ worldPointCovariance,}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structrgbd__slam_1_1_world_to_camera_matrix}{WorldToCameraMatrix}}\&\ worldToCamera,}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacergbd__slam_a668ec4e90f57f06678a0b85a12c38db3}{matrix33}}\&\ poseCovariance)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00083\ [[nodiscard]]\ \mbox{\hyperlink{structrgbd__slam_1_1_world_coordinate_covariance}{WorldCoordinateCovariance}}\ \mbox{\hyperlink{namespacergbd__slam_1_1utils_aea0efe85d8571e80a7c8665704cb0d9e}{get\_world\_point\_covariance}}(}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structrgbd__slam_1_1_camera_coordinate_covariance}{CameraCoordinateCovariance}}\&\ cameraPointCovariance,}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structrgbd__slam_1_1_camera_to_world_matrix}{CameraToWorldMatrix}}\&\ cameraToWorld,}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacergbd__slam_a668ec4e90f57f06678a0b85a12c38db3}{matrix33}}\&\ poseCovariance)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00091\ [[nodiscard]]\ \mbox{\hyperlink{structrgbd__slam_1_1_world_coordinate_covariance}{WorldCoordinateCovariance}}\ \mbox{\hyperlink{namespacergbd__slam_1_1utils_aea0efe85d8571e80a7c8665704cb0d9e}{get\_world\_point\_covariance}}(\textcolor{keyword}{const}\ ScreenCoordinate\&\ screenPoint,}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structrgbd__slam_1_1_camera_to_world_matrix}{CameraToWorldMatrix}}\&\ cameraToWorld,}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacergbd__slam_a668ec4e90f57f06678a0b85a12c38db3}{matrix33}}\&\ poseCovariance)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00101\ [[nodiscard]]\ \mbox{\hyperlink{structrgbd__slam_1_1_camera_coordinate_covariance}{CameraCoordinateCovariance}}\ \mbox{\hyperlink{namespacergbd__slam_1_1utils_a115c8ecf807d5970f1ad789bfedb04b4}{get\_camera\_point\_covariance}}(\textcolor{keyword}{const}\ ScreenCoordinate\&\ screenPoint)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00109\ [[nodiscard]]\ \mbox{\hyperlink{structrgbd__slam_1_1_camera_coordinate_covariance}{CameraCoordinateCovariance}}\ \mbox{\hyperlink{namespacergbd__slam_1_1utils_a115c8ecf807d5970f1ad789bfedb04b4}{get\_camera\_point\_covariance}}(}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ScreenCoordinate\&\ screenPoint,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structrgbd__slam_1_1_screen_coordinate_covariance}{ScreenCoordinateCovariance}}\&\ screenPointCovariance)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00118\ [[nodiscard]]\ \mbox{\hyperlink{namespacergbd__slam_a70f681ee932c57b80130eb960ccf435f}{matrix44}}\ \mbox{\hyperlink{namespacergbd__slam_1_1utils_a3735cd614fe750dfe0dc7ade7346b158}{compute\_plane\_covariance}}(\textcolor{keyword}{const}\ PlaneCoordinates\&\ planeParameters,}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacergbd__slam_a668ec4e90f57f06678a0b85a12c38db3}{matrix33}}\&\ pointCloudCovariance);}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00127\ [[nodiscard]]\ \mbox{\hyperlink{namespacergbd__slam_a668ec4e90f57f06678a0b85a12c38db3}{matrix33}}\ \mbox{\hyperlink{namespacergbd__slam_1_1utils_a071e281f17fe3f487e25e9cc9349a5a3}{compute\_reduced\_plane\_point\_cloud\_covariance}}(\textcolor{keyword}{const}\ PlaneCoordinates\&\ planeParameters,}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacergbd__slam_a70f681ee932c57b80130eb960ccf435f}{matrix44}}\&\ planeCloudCovariance);}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00139\ [[nodiscard]]\ \mbox{\hyperlink{namespacergbd__slam_a70f681ee932c57b80130eb960ccf435f}{matrix44}}\ \mbox{\hyperlink{namespacergbd__slam_1_1utils_adb9b794ab09890567eb981adabe2b566}{get\_world\_plane\_covariance}}(\textcolor{keyword}{const}\ PlaneCameraCoordinates\&\ planeCoordinates,}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structrgbd__slam_1_1_camera_to_world_matrix}{CameraToWorldMatrix}}\&\ cameraToWorldMatrix,}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structrgbd__slam_1_1_plane_camera_to_world_matrix}{PlaneCameraToWorldMatrix}}\&\ planeCameraToWorldMatrix,}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacergbd__slam_a70f681ee932c57b80130eb960ccf435f}{matrix44}}\&\ planeCovariance,}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacergbd__slam_a668ec4e90f57f06678a0b85a12c38db3}{matrix33}}\&\ worldPoseCovariance);}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \}\ \textcolor{comment}{//\ namespace\ rgbd\_slam::utils}}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
