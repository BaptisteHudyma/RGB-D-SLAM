\hypertarget{local__map_8hpp_source}{}\doxysection{local\+\_\+map.\+hpp}
\label{local__map_8hpp_source}\index{/home/baptou/Documents/code/robots/RGB\_SLAM/RGB-\/D-\/SLAM/src/map\_management/local\_map.hpp@{/home/baptou/Documents/code/robots/RGB\_SLAM/RGB-\/D-\/SLAM/src/map\_management/local\_map.hpp}}
\mbox{\hyperlink{local__map_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef RGBDSLAM\_MAPMANAGEMENT\_LOCALMAP\_HPP}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define RGBDSLAM\_MAPMANAGEMENT\_LOCALMAP\_HPP}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <list>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <opencv2/opencv.hpp>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <opencv2/xfeatures2d.hpp>}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{types_8hpp}{types.hpp}}"{}}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{matches__containers_8hpp}{matches\_containers.hpp}}"{}}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{map__point_8hpp}{map\_point.hpp}}"{}}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{keypoint__detection_8hpp}{keypoint\_detection.hpp}}"{}}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{primitive__detection_8hpp}{primitive\_detection.hpp}}"{}}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{pose_8hpp}{pose.hpp}}"{}}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{map__writer_8hpp}{map\_writer.hpp}}"{}}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacergbd__slam}{rgbd\_slam}} \{}
\DoxyCodeLine{20     \textcolor{keyword}{namespace }map\_management \{}
\DoxyCodeLine{21 }
\DoxyCodeLine{25         \textcolor{keyword}{class }\mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map}{Local\_Map}} \{}
\DoxyCodeLine{26             \textcolor{keyword}{public}:}
\DoxyCodeLine{27                 \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a55f49d47df2e5c63d581786b64645ee6}{Local\_Map}}();}
\DoxyCodeLine{28                 \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_aa418a6f97b3af08cc1738c599db63d27}{\string~Local\_Map}}();}
\DoxyCodeLine{29 }
\DoxyCodeLine{38                 \mbox{\hyperlink{namespacergbd__slam_1_1matches__containers_a69e137115cf0342c9d0dcc61d0823af9}{matches\_containers::match\_point\_container}} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_af81e3393fafec87ba9385745c1c43530}{find\_keypoint\_matches}}(\textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1utils_1_1_pose}{utils::Pose}}\& currentPose, \textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1features_1_1keypoints_1_1_keypoint___handler}{features::keypoints::Keypoint\_Handler}}\& detectedKeypoint); }
\DoxyCodeLine{39 }
\DoxyCodeLine{48                 \mbox{\hyperlink{namespacergbd__slam_1_1matches__containers_a97738459fd8c450454fb64fdce577492}{matches\_containers::match\_primitive\_container}} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a7c3fc00d5774f0984d8c6063af4100d7}{find\_primitive\_matches}}(\textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1utils_1_1_pose}{utils::Pose}}\& currentPose, \textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_1_1features_1_1primitives_a82fffe54c97a2ecd30ab76c0b1b1d910}{features::primitives::primitive\_container}}\& detectedPrimitives);}
\DoxyCodeLine{49 }
\DoxyCodeLine{50 }
\DoxyCodeLine{59                 \textcolor{keywordtype}{void} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_ac8af6754d457ae66408eaf5ee46b4352}{update}}(\textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1utils_1_1_pose}{utils::Pose}}\& previousPose, \textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1utils_1_1_pose}{utils::Pose}}\& optimizedPose, \textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1features_1_1keypoints_1_1_keypoint___handler}{features::keypoints::Keypoint\_Handler}}\& keypointObject, \textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_1_1matches__containers_a69e137115cf0342c9d0dcc61d0823af9}{matches\_containers::match\_point\_container}}\& outlierMatchedPoints);}
\DoxyCodeLine{60 }
\DoxyCodeLine{66                 \textcolor{keyword}{const} \mbox{\hyperlink{structrgbd__slam_1_1features_1_1keypoints_1_1_keypoints_with_id_struct}{features::keypoints::KeypointsWithIdStruct}} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a8e0a9d1f902a90b99b39e90dbd63cb73}{get\_tracked\_keypoints\_features}}() \textcolor{keyword}{const};}
\DoxyCodeLine{67 }
\DoxyCodeLine{71                 \textcolor{keywordtype}{void} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_ad1073f3d16e8549024d939620831cc1e}{reset}}();}
\DoxyCodeLine{72 }
\DoxyCodeLine{73 }
\DoxyCodeLine{81                 \textcolor{keywordtype}{void} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a3e49eafbe2cead93c62f0b3c71271d9b}{get\_debug\_image}}(\textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1utils_1_1_pose}{utils::Pose}}\& camPose, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} shouldDisplayStaged, cv::Mat\& debugImage) \textcolor{keyword}{const};}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 }
\DoxyCodeLine{84             \textcolor{keyword}{protected}:}
\DoxyCodeLine{85 }
\DoxyCodeLine{96                 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a0edf9ab397aa1078d84ad86b0e4687d3}{find\_match}}(\mbox{\hyperlink{structrgbd__slam_1_1map__management_1_1_i_map___point___with___tracking}{IMap\_Point\_With\_Tracking}}\& point, \textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1features_1_1keypoints_1_1_keypoint___handler}{features::keypoints::Keypoint\_Handler}}\& detectedKeypoint, \textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a4c5100025d8dbfb05b957c61197cc83a}{matrix44}}\& worldToCamMatrix, \mbox{\hyperlink{namespacergbd__slam_1_1matches__containers_a69e137115cf0342c9d0dcc61d0823af9}{matches\_containers::match\_point\_container}}\& matchedPoints);}
\DoxyCodeLine{97 }
\DoxyCodeLine{107                 \textcolor{keywordtype}{void} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a3b4e7b3ef6b097f5fd41144127c3febe}{update\_point\_match\_status}}(\mbox{\hyperlink{structrgbd__slam_1_1map__management_1_1_i_map___point___with___tracking}{IMap\_Point\_With\_Tracking}}\& mapPoint, \textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a2877fc3a278a20d5132bcd38e12faf69}{matrix33}}\& poseCovariance, \textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1features_1_1keypoints_1_1_keypoint___handler}{features::keypoints::Keypoint\_Handler}}\& keypointObject, \textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a4c5100025d8dbfb05b957c61197cc83a}{matrix44}}\& previousCameraToWorldMatrix, \textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a4c5100025d8dbfb05b957c61197cc83a}{matrix44}}\& cameraToWorldMatrix);}
\DoxyCodeLine{108 }
\DoxyCodeLine{117                 \textcolor{keywordtype}{void} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a9fa0963d137eee15a2eb9d25c8884039}{update\_local\_keypoint\_map}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a2877fc3a278a20d5132bcd38e12faf69}{matrix33}}\& poseCovariance, \textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a4c5100025d8dbfb05b957c61197cc83a}{matrix44}}\& previousCameraToWorldMatrix, \textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a4c5100025d8dbfb05b957c61197cc83a}{matrix44}}\& cameraToWorldMatrix, \textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1features_1_1keypoints_1_1_keypoint___handler}{features::keypoints::Keypoint\_Handler}}\& keypointObject);}
\DoxyCodeLine{118 }
\DoxyCodeLine{127                 \textcolor{keywordtype}{void} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a5b98f8c35f26a98bf33708e5006f1b9a}{update\_staged\_keypoints\_map}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a2877fc3a278a20d5132bcd38e12faf69}{matrix33}}\& poseCovariance, \textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a4c5100025d8dbfb05b957c61197cc83a}{matrix44}}\& previousCameraToWorldMatrix, \textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a4c5100025d8dbfb05b957c61197cc83a}{matrix44}}\& cameraToWorldMatrix, \textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1features_1_1keypoints_1_1_keypoint___handler}{features::keypoints::Keypoint\_Handler}}\& keypointObject);}
\DoxyCodeLine{128 }
\DoxyCodeLine{136                 \textcolor{keywordtype}{void} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a748a8d6a9575e8dad87269be79f09c6d}{add\_umatched\_keypoints\_to\_staged\_map}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a2877fc3a278a20d5132bcd38e12faf69}{matrix33}}\& poseCovariance, \textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a4c5100025d8dbfb05b957c61197cc83a}{matrix44}}\& cameraToWorldMatrix, \textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1features_1_1keypoints_1_1_keypoint___handler}{features::keypoints::Keypoint\_Handler}}\& keypointObject);}
\DoxyCodeLine{137 }
\DoxyCodeLine{141                 \textcolor{keywordtype}{void} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_af62ebdf2d7be0eca02c759a8cc1ea602}{update\_local\_to\_global}}();}
\DoxyCodeLine{142 }
\DoxyCodeLine{143 }
\DoxyCodeLine{152                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a162e33d06a66cceb6396ee123ed24ba4}{draw\_point\_on\_image}}(\textcolor{keyword}{const} \mbox{\hyperlink{structrgbd__slam_1_1map__management_1_1_i_map___point___with___tracking}{IMap\_Point\_With\_Tracking}}\& mapPoint, \textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_a4c5100025d8dbfb05b957c61197cc83a}{matrix44}}\& worldToCameraMatrix, \textcolor{keyword}{const} cv::Scalar\& pointColor, cv::Mat\& debugImage);}
\DoxyCodeLine{153 }
\DoxyCodeLine{154 }
\DoxyCodeLine{158                 \textcolor{keywordtype}{void} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a6922aeab012e88206c07c2079eef442e}{mark\_outliers\_as\_unmatched}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacergbd__slam_1_1matches__containers_a69e137115cf0342c9d0dcc61d0823af9}{matches\_containers::match\_point\_container}}\& outlierMatchedPoints);}
\DoxyCodeLine{159 }
\DoxyCodeLine{167                 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a2c95f09e7fc79f6d22ccbb0d5303a76f}{mark\_point\_with\_id\_as\_unmatched}}(\textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} pointId);}
\DoxyCodeLine{168 }
\DoxyCodeLine{172                 \textcolor{keywordtype}{void} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a2c95f09e7fc79f6d22ccbb0d5303a76f}{mark\_point\_with\_id\_as\_unmatched}}(\textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} pointId, \mbox{\hyperlink{structrgbd__slam_1_1map__management_1_1_i_map___point___with___tracking}{IMap\_Point\_With\_Tracking}}\& point);}
\DoxyCodeLine{173 }
\DoxyCodeLine{174             \textcolor{keyword}{private}:}
\DoxyCodeLine{175                 \textcolor{comment}{// local map point container}}
\DoxyCodeLine{176                 \textcolor{keyword}{typedef} std::map<size\_t, Map\_Point> point\_map\_container;}
\DoxyCodeLine{177                 \textcolor{comment}{// staged points container}}
\DoxyCodeLine{178                 \textcolor{keyword}{typedef} std::map<size\_t, Staged\_Point> staged\_point\_container;}
\DoxyCodeLine{179                 \textcolor{comment}{// local shape primitive map container}}
\DoxyCodeLine{180                 \textcolor{keyword}{typedef} std::list<features::primitives::primitive\_uniq\_ptr> primitive\_map\_container; }
\DoxyCodeLine{181 }
\DoxyCodeLine{182                 \textcolor{comment}{// Local map contains world points with a good confidence}}
\DoxyCodeLine{183                 point\_map\_container \_localPointMap;}
\DoxyCodeLine{184                 \textcolor{comment}{// Staged points are potential new map points, waiting to confirm confidence}}
\DoxyCodeLine{185                 staged\_point\_container \_stagedPoints;}
\DoxyCodeLine{186                 \textcolor{comment}{// Hold unmatched detected point indexes, to add in the staged point container}}
\DoxyCodeLine{187                 std::vector<bool> \_isPointMatched;}
\DoxyCodeLine{188 }
\DoxyCodeLine{189                 \textcolor{comment}{//local primitive map}}
\DoxyCodeLine{190                 primitive\_map\_container \_localPrimitiveMap;}
\DoxyCodeLine{191                 std::unordered\_map<int, uint> \_previousPrimitiveAssociation;}
\DoxyCodeLine{192 }
\DoxyCodeLine{193 }
\DoxyCodeLine{194                 \mbox{\hyperlink{classrgbd__slam_1_1utils_1_1_x_y_z___map___writer}{utils::XYZ\_Map\_Writer}}* \_mapWriter; }
\DoxyCodeLine{195 }
\DoxyCodeLine{196                 \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map_a55f49d47df2e5c63d581786b64645ee6}{Local\_Map}}(\textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map}{Local\_Map}}\& map) = \textcolor{keyword}{delete};}
\DoxyCodeLine{197                 \textcolor{keywordtype}{void} operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classrgbd__slam_1_1map__management_1_1_local___map}{Local\_Map}}\& map) = \textcolor{keyword}{delete};}
\DoxyCodeLine{198         \};}
\DoxyCodeLine{199 }
\DoxyCodeLine{200     \}}
\DoxyCodeLine{201 \}}
\DoxyCodeLine{202 }
\DoxyCodeLine{203 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
